export VGIT_USERNAME=simon-weber

PS1_DEFAULT="$PS1"
PS1_PERSONAL="$PS1(*p*) "

change_context() {
    if [ "$PWD" != "$PREV_CWD" ]; then
        PREV_CWD="$PWD";
        PREV_CONTEXT="$CURRENT_CONTEXT"

        if [[ "$PWD" =~ /Users/simonweber/other.* ]];
        then
            CURRENT_CONTEXT=personal
        else
            CURRENT_CONTEXT=work
        fi

        if [[ "$CURRENT_CONTEXT" != "$PREV_CONTEXT" ]];
        then
            echo "changing context to: $CURRENT_CONTEXT"
            len=${#_append_for_personal}

            case $CURRENT_CONTEXT in
                work)
                    go_work
                    ;;
                personal)
                    go_personal
                    ;;
            esac
        fi
    fi
}

go_work() {
    export PS1="$PS1_DEFAULT"
    git config --global user.email "simon.weber@venmo.com"
}

go_personal() {
    export PS1="$PS1_PERSONAL"
    git config --global user.email "simon@simonmweber.com"
}

CURRENT_CONTEXT=work
export PROMPT_COMMAND=change_context
