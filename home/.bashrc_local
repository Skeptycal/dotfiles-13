PS1_DEFAULT="$PS1"
PS1_PERSONAL="$PS1(*p*) "

change_context() {
    if [ "$PWD" != "$PREV_CWD" ]; then
        PREV_CWD="$PWD";
        PREV_CONTEXT="$CURRENT_CONTEXT"

        if [[ "$PWD" =~ /Users/simonweber/other.* ]];
        then
            CURRENT_CONTEXT=personal
        else
            CURRENT_CONTEXT=work
        fi

        if [[ "$CURRENT_CONTEXT" != "$PREV_CONTEXT" ]];
        then
            echo "changing context to: $CURRENT_CONTEXT"
            len=${#_append_for_personal}

            case $CURRENT_CONTEXT in
                work)
                    go_work
                    ;;
                personal)
                    go_personal
                    ;;
            esac
        fi
    fi
}

go_work() {
    export PS1="$PS1_DEFAULT"
    export GIT_AUTHOR_NAME="Simon Weber"
    export GIT_AUTHOR_EMAIL="simon@venmo.com"
    export GIT_COMMITTER_NAME="$GIT_AUTHOR_NAME"
    export GIT_COMMITTER_EMAIL="$GIT_AUTHOR_EMAIL"
}

go_personal() {
    export PS1="$PS1_PERSONAL"
    export GIT_AUTHOR_NAME="Simon Weber"
    export GIT_AUTHOR_EMAIL="simon@simonmweber.com"
    export GIT_COMMITTER_NAME="$GIT_AUTHOR_NAME"
    export GIT_COMMITTER_EMAIL="$GIT_AUTHOR_EMAIL"
}

# homebrew path setup
export PATH="$(brew --prefix coreutils)/libexec/gnubin:/usr/local/bin:$PATH"

if which pyenv > /dev/null; then eval "$(pyenv init -)"; fi

# use brew gnuutils with man.
# source: https://gist.github.com/quickshiftin/9130153
alias man='_() { echo $1; man -M $(brew --prefix)/opt/coreutils/libexec/gnuman $1 1>/dev/null 2>&1;  if [ "$?" -eq 0 ]; then man -M $(brew --prefix)/opt/coreutils/libexec/gnuman $1; else man $1; fi }; _'

CURRENT_CONTEXT=work
export PROMPT_COMMAND=change_context
